{"version":3,"file":"589.renderer.js","mappings":"2LACO,MAAMA,EAAeC,IAQ1B,IAAIC,EAAQ,EACRC,EAAI,IAAIC,IACZ,KAAMF,EAAQD,EAAKI,QAAQ,CACzB,IAAIC,EAAIL,EAAKC,GACTK,EAAIN,EAAKC,EAAQ,GACjBM,EAAIP,EAAKC,EAAQ,GACbD,EAAKC,EAAQ,GACrBA,GAAgB,EAEhB,IAAIO,EAAM,GAAGH,KAAKC,KAAKC,IACnBE,EAAIP,EAAEQ,IAAIF,GACXC,EACDP,EAAES,IAAIH,EAAIC,EAAI,GAEdP,EAAES,IAAIH,EAAI,E,CAKd,OAFAI,QAAQC,IAAIC,MAAMC,KAAKb,EAAEc,QAAQZ,QAE1BF,CAAC,EAIGe,EAAc,CAACC,EAAsBC,KAEhD,IAEIC,EAFqBN,MAAMC,KAAKG,EAAEG,UAEHC,MAAK,CAACC,EAAEhB,IAClCA,EAAIgB,IAGTC,EAAS,EAEVJ,EAAUhB,OAASe,IAAGA,EAAIC,EAAUhB,QACvCoB,EAASJ,EAAUD,EAAI,GACvB,IAAIM,EAAe,GAInB,OAHAP,EAAEQ,SAAQ,CAACC,EAAMnB,KACXmB,GAASH,GAAQC,EAAGG,KAAKpB,EAAI,IAE5BiB,CAAE,EAMEI,EAAWC,IACtB,MAAM5B,EAAI4B,EAAMC,MAAM,KACtB,MAAO,IAAM,EAAAC,IAAA,IAAQC,SAAS/B,EAAE,IAAI+B,SAAS/B,EAAE,IAAI+B,SAAS/B,EAAE,IAAI,C","sources":["webpack://magic-tools/./src/renderer/App/ImageColor/lib.ts"],"sourcesContent":["// 获取 ColorMap  key = r,g,b  value 是 出现在次数 Map<string(r,g,b), number(出现次数)>\r\nexport const genColorMap = (data :Uint8ClampedArray) :Map<string,number> => {\r\n  /**\r\n    ImageData 对象中的每个像素，都存在着四方面的信息，即 RGBA 值：\r\n      R - 红色 (0-255)\r\n      G - 绿色 (0-255)\r\n      B - 蓝色 (0-255)\r\n      A - alpha 通道 (0-255; 0 是透明的，255 是完全可见的)\r\n  */ \r\n  let start = 0;\r\n  let c = new Map<string,number>;\r\n  while(start < data.length) {\r\n    let r = data[start];     // R - 红色 (0-255)\r\n    let g = data[start + 1]; // G - 绿色 (0-255)\r\n    let b = data[start + 2]; // B - 蓝色 (0-255)\r\n    let a = data[start + 3]; // alpha 通道 (0-255; 0 是透明的，255 是完全可见的)\r\n    start = start + 4\r\n    //console.log(`RGBA(${r},${g},${b})`);\r\n    let key = `${r},${g},${b}`;\r\n    let i = c.get(key);\r\n    if(i) {\r\n      c.set(key,i + 1);\r\n    } else {\r\n      c.set(key,1);\r\n    }\r\n  }\r\n  console.log(Array.from(c.keys()).length);\r\n  // todo 需要做一个近视值数据合并\r\n  return c;\r\n};\r\n\r\n// 获取 TopN 的数据\r\nexport const getTopArray = (m :Map<string,number>,n :number) :String[] => {\r\n  // 先取出所有值 values \r\n  let arr :Array<number> = Array.from(m.values());\r\n  // 排序完成的数组\r\n  let sortedArr :Array<number> = arr.sort((a,b)=> {\r\n    return b - a;\r\n  });\r\n  // 取 Top N n = 10\r\n  let filter = 0;\r\n  // 如果数量不够就取所有长度 返回所有 map 的 key 就行了\r\n  if(sortedArr.length < n) n = sortedArr.length;\r\n  filter = sortedArr[n - 1];\r\n  let cr :String[] = [];\r\n  m.forEach((value,key) => {\r\n    if( value >= filter) cr.push(key);\r\n  })\r\n  return cr;\r\n}\r\n\r\nimport {rgb } from \"color-convert\"\r\n\r\n// r,g,b 格式转成  #rgb\r\nexport const rgb2Hex = (color :string) :string => {\r\n  const c = color.split(\",\")\r\n  return \"#\" + rgb.hex(parseInt(c[0]),parseInt(c[1]),parseInt(c[2]));\r\n} "],"names":["genColorMap","data","start","c","Map","length","r","g","b","key","i","get","set","console","log","Array","from","keys","getTopArray","m","n","sortedArr","values","sort","a","filter","cr","forEach","value","push","rgb2Hex","color","split","rgb","parseInt"],"sourceRoot":""}